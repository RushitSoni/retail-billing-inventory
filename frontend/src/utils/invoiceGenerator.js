import jsPDF from "jspdf";
import autoTable from "jspdf-autotable";

const generateInvoice = async(shopDetails, billMaker, customerDetails, billItems, grandTotal, installments) => {
    const doc = new jsPDF();
   
    
    //Header
    const logoBase64 = "data:image/jpeg;base64,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"; // Use your full Base64 string here
    const logoWidth = 40; 
    const logoHeight = 40; 
    
    // Calculate X position to center logo and text
    const pageWidth = doc.internal.pageSize.width;
    const textWidth = doc.getTextWidth(shopDetails);
    const totalWidth = logoWidth + textWidth + 25; 
    const centerX = (pageWidth - totalWidth) / 2;
    
    // Add logo
    doc.addImage(logoBase64, "JPEG", centerX, 0, logoWidth, logoHeight);
    
    // Add shop name next to logo
    doc.setFont("helvetica", "bold");
    doc.setFontSize(18);
    doc.text(shopDetails, centerX + logoWidth , 22);
    doc.line(0, 32, 10000, 30);

    // Add Shop Address Below Name
    doc.setFontSize(12);
    //doc.text(shopDetails.address, textX, 60, { align: "center" });

    doc.text(`Time: ${new Date().toLocaleTimeString()}`, 140, 40);
    doc.text(`Date: ${new Date().toLocaleDateString()}`, 140, 50);   
    
    doc.text(`Branch    : Dabhoi`, 25, 40);
    doc.text(`Bill Maker: ${billMaker}`, 25, 50);

    // Customer Details in Two Columns
    doc.setFont("helvetica", "bold");
    doc.text("Customer Details:",25, 65);
    doc.setFont("helvetica", "normal");
    // Left Column
    doc.text(`Name  : ${customerDetails.name}`, 25, 75);
    doc.text(`Phone : ${customerDetails.phone}`, 25, 85);
    // Right Column (Aligned at x = 110)
    doc.text(`Email  : ${customerDetails.email}`, 140, 75);
    doc.text(`Address: ${customerDetails.address}`, 140, 85);

    // Table for Bill Items
    autoTable(doc, {
        startY: 95,
        head: [
            ["Item Number", "Item Name", "Price (Rs.)", "Quantity", "Total (Rs.)"]
        ],
        body: billItems.map((item, index) => [
            index + 1,
            item.name,
            item.price,
            item.quantity,
            item.price * item.quantity,
        ]),
        theme: "grid",
    });

    // Grand Total
    doc.setFont("helvetica", "bold");
    doc.text(`Grand Total: Rs. ${grandTotal}`, 20, doc.lastAutoTable.finalY + 10);

    // Page 2: Installments (if applicable)
    if (installments && installments.length > 1) {
        doc.addPage();
        doc.text("Installment Plan :", 20, 20);
        autoTable(doc, {
            startY: 40,
            head: [
                ["Installment No.", "Amount (Rs.)", "Due Date"]
            ],
            body: installments.map((installment) => [
                installment.installmentNo,
                installment.amount,
                installment.dueDate,
            ]),
            theme: "grid",
        });
    }
   
   // doc.save("invoice.pdf");

   // Convert PDF to Blob
   const pdfBlob = doc.output("blob");

   // Prepare FormData to send to the backend
   const formData = new FormData();
   formData.append("file", pdfBlob, "invoice.pdf");
   formData.append("email", "rushitpsoni2002@gmail.com");

   try {
       const response = await fetch("http://localhost:8000/send-invoice-email", {
           method: "POST",
           body: formData,
       });
       const result = await response.json();
       if (result.success) {
           console.log("Invoice sent successfully to email!");
       } else {
           console.log("Failed to send invoice.");
       }
   } catch (error) {
       console.error("Error sending invoice:", error);
   }

};

export default generateInvoice;